<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:controls="clr-namespace:SRAFrontend.Controls"
             mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="50"
             x:Class="SRAFrontend.Controls.ControlPanelView"
             x:DataType="controls:ControlPanelViewModel">
    <StackPanel
        Orientation="Horizontal"
        HorizontalAlignment="Right"
        Spacing="10">
        <TextBox Width="200"
                 Watermark="请输入配置名称"
                 Text="{Binding NewConfigName}"
                 IsVisible="{Binding IsAddConfigOpen}"/>
        <Button Classes="Icon" Content="+"
                Command="{Binding OpenAddConfigCommand}"
                IsVisible="{Binding !IsAddConfigOpen}"/>
        <Button Classes="Flat Icon" Content="✓"
                Command="{Binding AddConfigCommand}"
                IsVisible="{Binding IsAddConfigOpen}"/>
        <Button Classes="Icon" Content="-" 
                Command="{Binding RemoveConfigCommand}"/>

        <ComboBox SelectedIndex="{Binding Cache.CurrentConfigIndex}"
                  SelectedValue="{Binding Cache.CurrentConfigName}"
                  Width="150" ItemsSource="{Binding Cache.ConfigNames}">
        </ComboBox>

        <SplitButton Content="{Binding Cache.StartMode}"
                     Classes="Flat Rounded"
                     Command="{Binding StartButtonCommand}"
                     IsVisible="{Binding CanStart}"
                     ToolTip.Tip="以当前模式运行任务">
            <SplitButton.Flyout>
                <MenuFlyout>
                    <MenuItem Header="Current" 
                              Command="{Binding SwitchStartModeCommand}" 
                              CommandParameter="Current"
                              ToolTip.Tip="运行当前选中配置"/>
                    <MenuItem Header="All" 
                              Command="{Binding SwitchStartModeCommand}" 
                              CommandParameter="All"
                              ToolTip.Tip="运行全部配置"/>
                    <MenuItem Header="Save Only" 
                              Command="{Binding SwitchStartModeCommand}"
                              CommandParameter="Save Only"
                              ToolTip.Tip="仅保存"/>
                </MenuFlyout>
            </SplitButton.Flyout>
        </SplitButton>
        <Button Classes="Flat Rounded"
                Content="Stop"
                IsVisible="{Binding !CanStart}"
                Command="{Binding StopButtonCommand}"></Button>
    </StackPanel>
</UserControl>
