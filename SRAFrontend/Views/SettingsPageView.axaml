<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:suki="https://github.com/kikipoulet/SukiUI"
             xmlns:objectModel="clr-namespace:System.Collections.ObjectModel;assembly=System.ObjectModel"
             xmlns:viewModels="clr-namespace:SRAFrontend.ViewModels"
             xmlns:lang="clr-namespace:SRAFrontend.Localization"
             xmlns:models="clr-namespace:SRAFrontend.Models"
             mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="450"
             x:Class="SRAFrontend.Views.SettingsPageView"
             x:DataType="viewModels:SettingsPageViewModel"
             FontSize="16">
    <suki:SukiStackPage>
        <suki:SukiStackPage.Content>
            <suki:SettingsLayout Name="{x:Static lang:Resources.SettingText}">
                <suki:SettingsLayout.Styles>
                    <Style Selector="Label">
                        <Setter Property="VerticalAlignment" Value="Center" />
                    </Style>
                    <Style Selector="Grid">
                        <Setter Property="ColumnSpacing" Value="10" />
                    </Style>
                </suki:SettingsLayout.Styles>
                <suki:SettingsLayout.Items>
                    <objectModel:ObservableCollection x:TypeArguments="suki:SettingsLayoutItem">
                        <suki:SettingsLayoutItem Header="{x:Static lang:Resources.TaskSettingsText}">
                            <suki:SettingsLayoutItem.Content>
                                <StackPanel>
                                    <!-- <Grid ColumnDefinitions="Auto,*,Auto" ToolTip.Tip="已过时，无效的设置项" > -->
                                    <!--     <Label Classes="icon">&#xe40c;</Label> -->
                                    <!--     <Label Grid.Column="1" Content="{x:Static lang:Resources.ThreadSafetyText}"/> -->
                                    <!--     <ToggleSwitch Grid.Column="2" IsChecked="{Binding Settings.ThreadSafety}" /> -->
                                    <!-- </Grid> -->

                                    <Grid ColumnDefinitions="Auto, *, Auto">
                                        <Label Classes="icon">&#xe310;</Label>
                                        <Label Grid.Column="1"
                                               Content="{x:Static lang:Resources.ZoomText}"
                                               ToolTip.Tip="与系统显示设置的缩放对应。自动获取" />
                                        <NumericUpDown Grid.Column="2" FormatString="0.00"
                                                       Value="{Binding Settings.Zoom}"
                                                       Increment="0.25" Minimum="0"
                                                       Maximum="5" />
                                    </Grid>
                                    <Grid ColumnDefinitions="Auto, *, Auto">
                                        <Label Classes="icon">&#xee60;</Label>
                                        <Label Grid.Column="1" Content="{x:Static lang:Resources.ConfidenceText}" />
                                        <NumericUpDown Grid.Column="2" FormatString="0.00"
                                                       Value="{Binding Settings.ConfidenceThreshold}"
                                                       Increment="0.01" Minimum="0"
                                                       Maximum="1" />
                                    </Grid>
                                    <!-- 启动/停止 快捷键（任务通用设置） -->
                                    <Grid ColumnDefinitions="Auto, *, Auto">
                                        <Label Classes="icon">&#xE3E4;</Label>
                                        <Label Grid.Column="1" Content="{x:Static lang:Resources.StopHotkeyText}" />
                                        <Button Grid.Column="2" MinWidth="100"
                                                Content="{Binding StartStopKey.CurrentKey}"
                                                Command="{Binding StartStopKey.ModifyKeyCommand}" />
                                    </Grid>
                                </StackPanel>
                            </suki:SettingsLayoutItem.Content>
                        </suki:SettingsLayoutItem>
                        <!-- 新增快捷键设置分组，插入在 任务通用设置 与 显示 之间 -->
                        <suki:SettingsLayoutItem Header="{x:Static lang:Resources.HotkeysText}">
                            <suki:SettingsLayoutItem.Content>
                                <StackPanel>
                                    <TextBlock Text="{x:Static lang:Resources.ModifyHoldText}" FontStyle="Italic"
                                               Margin="0,0,0,8" />
                                    <ItemsControl ItemsSource="{Binding CustomizableKeys}">
                                        <ItemsControl.ItemTemplate>
                                            <DataTemplate x:DataType="models:CustomizableKey">
                                                <Grid ColumnDefinitions="Auto, *, Auto, Auto" Margin="0,0,0,4">
                                                    <Label Grid.Column="0" Classes="icon"
                                                           Content="{Binding IconText}" />
                                                    <Label Grid.Column="1" Content="{Binding DisplayText}" />
                                                    <Button Grid.Column="2" MinWidth="100"
                                                            Content="{Binding CurrentKey}"
                                                            Command="{Binding ModifyKeyCommand}"/>
                                                    <Button Grid.Column="3"
                                                            Classes="Icon"
                                                            FontFamily="{StaticResource Phosphor}"
                                                            Content="&#xE036;" 
                                                            Command="{Binding ResetToDefaultCommand}"/>
                                                </Grid>
                                            </DataTemplate>
                                        </ItemsControl.ItemTemplate>
                                    </ItemsControl>
                                </StackPanel>
                            </suki:SettingsLayoutItem.Content>
                        </suki:SettingsLayoutItem>
                        <suki:SettingsLayoutItem Header="{x:Static lang:Resources.DisplayText}">
                            <suki:SettingsLayoutItem.Content>
                                <StackPanel>
                                    <!-- <Grid ColumnDefinitions="Auto,*,Auto"> -->
                                    <!--     <Label Grid.Column="0" Classes="icon">&#xe6c8;</Label> -->
                                    <!--     <Label Grid.Column="1" Content="{x:Static lang:Resources.ThemeText}" /> -->
                                    <!--     <ComboBox Grid.Column="2" SelectedIndex="{Binding ThemeSelectedIndex}"> -->
                                    <!--         <ComboBoxItem Content="{x:Static lang:Resources.LightText}" /> -->
                                    <!--         <ComboBoxItem Content="{x:Static lang:Resources.DarkText}" /> -->
                                    <!--     </ComboBox> -->
                                    <!-- </Grid> -->
                                    <Grid ColumnDefinitions="Auto, *, Auto">
                                        <Label Grid.Column="0" Classes="icon" Content="&#xE2CA;" />
                                        <Label Grid.Column="1" Content="{x:Static lang:Resources.BackgroundImageText}" />
                                        <TextBox Grid.Column="2"
                                                 Width="400"
                                                 Watermark="{x:Static lang:Resources.BgImagePathWatermarkText}"
                                                 Text="{Binding Settings.BackgroundImagePath}" />
                                    </Grid>
                                    <Grid ColumnDefinitions="Auto, *, Auto, 28">
                                        <Label Grid.Column="0" Classes="icon" Content="&#xEB42;" />
                                        <Label Grid.Column="1"
                                               Content="{x:Static lang:Resources.BackgroundImageOpacityText}" />
                                        <Slider Grid.Column="2"
                                                Width="200"
                                                Maximum="1"
                                                TickFrequency="0.01"
                                                IsSnapToTickEnabled="True"
                                                Value="{Binding Settings.BackgroundOpacity}" />
                                        <TextBlock Grid.Column="3"
                                                   Text="{Binding Settings.BackgroundOpacity}"
                                                   VerticalAlignment="Center"
                                                   FontWeight="DemiBold" />
                                    </Grid>
                                    <Grid ColumnDefinitions="Auto, *, Auto, 28">
                                        <Label Grid.Column="0" Classes="icon" Content="&#xEB42;" />
                                        <Label Grid.Column="1"
                                               Content="{x:Static lang:Resources.ControlPanelOpacityText}" />
                                        <Slider Grid.Column="2"
                                                Width="200"
                                                Maximum="1"
                                                TickFrequency="0.01"
                                                IsSnapToTickEnabled="True"
                                                Value="{Binding Settings.CtrlPanelOpacity}" />
                                        <TextBlock Grid.Column="3"
                                                   Text="{Binding Settings.CtrlPanelOpacity}"
                                                   VerticalAlignment="Center"
                                                   FontWeight="DemiBold" />
                                    </Grid>
                                    <Grid ColumnDefinitions="Auto,*,Auto">
                                        <Label Grid.Column="0" Classes="icon">&#xe4a2;</Label>
                                        <Label Grid.Column="1" Content="{x:Static lang:Resources.LanguageText}" />
                                        <ComboBox Grid.Column="2" SelectedIndex="{Binding Settings.Language}">
                                            <ComboBoxItem>简体中文</ComboBoxItem>
                                            <ComboBoxItem>English</ComboBoxItem>
                                        </ComboBox>
                                    </Grid>
                                </StackPanel>
                            </suki:SettingsLayoutItem.Content>
                        </suki:SettingsLayoutItem>

                        <suki:SettingsLayoutItem Header="{x:Static lang:Resources.RegularText}">
                            <suki:SettingsLayoutItem.Content>
                                <StackPanel>
                                    <Expander Header="{x:Static lang:Resources.NotificationText}"
                                              HorizontalAlignment="Stretch" IsExpanded="True">
                                        <StackPanel Spacing="10">
                                            <Grid ColumnDefinitions="Auto,*,Auto">
                                                <Label Classes="icon">&#xe0ce;</Label>
                                                <Label Grid.Column="1"
                                                       Content="{x:Static lang:Resources.AllowNotificationText}" />
                                                <ToggleSwitch Grid.Column="2"
                                                              IsChecked="{Binding Settings.AllowNotifications}" />
                                            </Grid>
                                            <CheckBox Content="{x:Static lang:Resources.SystemNotificationText}"
                                                      IsChecked="{Binding Settings.AllowSystemNotifications}" />
                                            <CheckBox Content="{x:Static lang:Resources.EmailNotificationText}"
                                                      IsChecked="{Binding Settings.AllowEmailNotifications}" />
                                            <Expander Header="{x:Static lang:Resources.SmtpSettingsText}">
                                                <Grid RowDefinitions="Auto,*,*,*,*" ColumnDefinitions="*,*">
                                                    <Label Grid.Row="0" Grid.Column="0" Content="{x:Static lang:Resources.SmtpServerText}" />
                                                    <TextBox Grid.Row="0" Grid.Column="1"
                                                             Text="{Binding Settings.SmtpServer}"
                                                             Watermark="smtp.qq.com" />
                                                    <Label Grid.Row="1" Grid.Column="0" Content="{x:Static lang:Resources.SmtpPortText}" />
                                                    <TextBox Grid.Row="1" Grid.Column="1"
                                                             Text="{Binding Settings.SmtpPort}"
                                                             Watermark="465" />
                                                    <Label Grid.Row="2" Grid.Column="0" Content="{x:Static lang:Resources.SenderEmailAddrText}" />
                                                    <TextBox Grid.Row="2" Grid.Column="1"
                                                             Text="{Binding Settings.EmailSender}"
                                                             Watermark="123456@qq.com" />
                                                    <Label Grid.Row="3" Grid.Column="0" Content="{x:Static lang:Resources.AuthorCodeText}" />
                                                    <TextBox Grid.Row="3" Grid.Column="1"
                                                             Text="{Binding Settings.EmailAuthCode}"
                                                             Watermark="123456" />
                                                    <Label Grid.Row="4" Grid.Column="0" Content="{x:Static lang:Resources.ReceiverEmailAddrText}" />
                                                    <TextBox Grid.Row="4" Grid.Column="1"
                                                             Text="{Binding Settings.EmailReceiver}"
                                                             Watermark="123456@qq.com" />
                                                </Grid>
                                            </Expander>
                                        </StackPanel>
                                    </Expander>
                                    <!-- <Grid ColumnDefinitions="Auto,*,Auto"> -->
                                    <!-- <Label Grid.Column="0" Classes="icon">&#xe0f4;</Label> -->
                                    <!-- <Label Grid.Column="1" Content="{x:Static lang:Resources.DefaultPageText}" /> -->
                                    <!-- <ComboBox Grid.Column="2" SelectedIndex="0"> -->
                                    <!-- <ComboBoxItem>Page1</ComboBoxItem> -->
                                    <!-- <ComboBoxItem>Page2</ComboBoxItem> -->
                                    <!-- <ComboBoxItem>Page3</ComboBoxItem> -->
                                    <!-- </ComboBox> -->
                                    <!-- </Grid> -->

                                    <!-- <Grid ColumnDefinitions="Auto,*,Auto" ToolTip.Tip="SRA需要管理员权限，无法使用开机自启，请使用计划任务" > -->
                                    <!--     <Label Classes="icon">&#xe586;</Label> -->
                                    <!--     <Label Grid.Column="1" Content="{x:Static lang:Resources.StartUpText}"/> -->
                                    <!--     <ToggleSwitch Grid.Column="2" -->
                                    <!--                   IsChecked="{Binding Settings.EnableStartupLaunch}" -->
                                    <!--                   IsEnabled="False" /> -->
                                    <!-- </Grid> -->
                                    <!-- -->
                                    <!-- <Grid ColumnDefinitions="Auto,*,Auto"> -->
                                    <!--     <Label Classes="icon">&#xe434;</Label> -->
                                    <!--     <Label Grid.Column="1" Content="{x:Static lang:Resources.EnableTrayIconText}" /> -->
                                    <!--     <ToggleSwitch Grid.Column="2" -->
                                    <!--                   IsChecked="{Binding Settings.EnableMinimizeToTray}" -->
                                    <!--                   IsEnabled="False" /> -->
                                    <!-- </Grid> -->
                                    <Button Content="{x:Static lang:Resources.CreateShortcutText}"
                                            HorizontalAlignment="Left"
                                            Command="{Binding CreateDesktopShortcutCommand}"/>
                                </StackPanel>
                            </suki:SettingsLayoutItem.Content>
                        </suki:SettingsLayoutItem>

                        <suki:SettingsLayoutItem Header="{x:Static lang:Resources.UpdateText}">
                            <suki:SettingsLayoutItem.Content>
                                <StackPanel>
                                    <Button Content="{x:Static lang:Resources.CheckForUpdateText}"
                                            HorizontalAlignment="Left"
                                            Command="{Binding CheckForUpdatesCommand}" />
                                    <Grid ColumnDefinitions="Auto,*,Auto">
                                        <Label Classes="icon">&#xe094;</Label>
                                        <Label Grid.Column="1"
                                               Content="{x:Static lang:Resources.AutoUpdateText}"
                                               ToolTip.Tip="{x:Static lang:Resources.AutoUpdateTipText}" />
                                        <ToggleSwitch Grid.Column="2" IsChecked="{Binding Settings.EnableAutoUpdate}" />
                                    </Grid>

                                    <Grid ColumnDefinitions="Auto, *, *">
                                        <Label Classes="icon">&#xed6a;</Label>
                                        <Label Grid.Column="1"
                                               Content="{x:Static lang:Resources.MirrorChyanText}"
                                               ToolTip.Tip="{x:Static lang:Resources.MirrorChyanTipText}" />
                                        <StackPanel Grid.Column="2">
                                            <TextBox
                                                Watermark="Enter You CDK"
                                                PasswordChar="*"
                                                Text="{Binding MirrorChyanCdk}" />
                                            <TextBlock Text="{Binding Cache.CdkStatus}"
                                                       Foreground="{Binding Cache.CdkStatusForeground}" />
                                        </StackPanel>

                                    </Grid>

                                    <Grid ColumnDefinitions="Auto, *, *">
                                        <Label Classes="icon">&#xebaa;</Label>
                                        <Label Grid.Column="1" Content="{x:Static lang:Resources.UpdateChannelText}" />
                                        <ComboBox Grid.Column="2" SelectedIndex="{Binding Settings.DownloadChannel}">
                                            <ComboBoxItem>Mirror 酱</ComboBoxItem>
                                            <ComboBoxItem>GitHub</ComboBoxItem>
                                            <ComboBoxItem>Auto-MAS</ComboBoxItem>
                                        </ComboBox>
                                    </Grid>
                                    <Grid ColumnDefinitions="Auto, *, *">
                                        <Label Classes="icon">&#xe77e;</Label>
                                        <Label Grid.Column="1"
                                               Content="{x:Static lang:Resources.AppChannelText}"
                                               ToolTip.Tip="y" />
                                        <ComboBox Grid.Column="2" SelectedIndex="{Binding Settings.AppChannel}">
                                            <ComboBoxItem>stable</ComboBoxItem>
                                            <ComboBoxItem>beta</ComboBoxItem>
                                        </ComboBox>
                                    </Grid>
                                </StackPanel>
                            </suki:SettingsLayoutItem.Content>
                        </suki:SettingsLayoutItem>

                        <suki:SettingsLayoutItem Header="{x:Static lang:Resources.AdvanceText}">
                            <suki:SettingsLayoutItem.Content>
                                <StackPanel>
                                    <StackPanel Orientation="Horizontal" Spacing="8">
                                        <Button Content="{x:Static lang:Resources.BeLogsFolderText}"
                                                Command="{Binding OpenFolderCommand}"
                                                CommandParameter="backendLogs"/>
                                        <Button Content="{x:Static lang:Resources.FeLogsFolder}"
                                                Command="{Binding OpenFolderCommand}"
                                                CommandParameter="frontendLogs"/>
                                        <Button Content="{x:Static lang:Resources.ConfigsFolder}"
                                                Command="{Binding OpenFolderCommand}"
                                                CommandParameter="configs"/>
                                        <Button Content="{x:Static lang:Resources.AppDataFolder}"
                                                Command="{Binding OpenFolderCommand}"
                                                CommandParameter="appdata"/>
                                    </StackPanel>
                                    <Grid ColumnDefinitions="Auto, *, Auto">
                                        <Label Classes="icon">&#xe184;</Label>
                                        <Label Grid.Column="1"
                                               Content="{x:Static lang:Resources.ResourceIntegrityCheckText}" />
                                        <Button Grid.Column="2" IsEnabled="False">Check</Button>
                                    </Grid>
                                </StackPanel>
                            </suki:SettingsLayoutItem.Content>
                        </suki:SettingsLayoutItem>

                        <suki:SettingsLayoutItem Header="{x:Static lang:Resources.AboutText}">
                            <suki:SettingsLayoutItem.Content>
                                <StackPanel>
                                    <TextBlock TextWrapping="Wrap" xml:space="preserve">
版本 / Version : <Run Text="{Binding VersionText}" />
© 2024-2025 StarRailAssistant, All rights reserved.

链接 / Links :
<Grid ColumnDefinitions="*,*,*,*,*,*" RowDefinitions="*,*" ColumnSpacing="20" RowSpacing="10">
    <HyperlinkButton NavigateUri="https://starrailassistant.top" Content="SRA官网" />
    <HyperlinkButton Grid.Row="0" Grid.Column="1" NavigateUri="https://github.com/Shasnow/StarRailAssistant"
                     Content="开放源代码仓库(GitHub)" />
    <HyperlinkButton Grid.Row="0" Grid.Column="2" NavigateUri="https://mirrorchyan.com/zh/get-start?source=sra-about"
                     Content="Mirror 酱" />
    <HyperlinkButton Grid.Row="0" Grid.Column="3" NavigateUri="https://qm.qq.com/q/u6iJ4lUlLW" Content="用户群(QQ)" />
    <HyperlinkButton Grid.Row="0" Grid.Column="4" NavigateUri="https://avaloniaui.net/" Content="Avalonia UI" />
    <HyperlinkButton Grid.Row="0" Grid.Column="5" NavigateUri="https://dotnet.microsoft.com" Content=".NET" />
    <HyperlinkButton Grid.Row="1" Grid.Column="0" NavigateUri="https://www.python.org/" Content="Python" />
</Grid>
                                    </TextBlock>
                                </StackPanel>
                            </suki:SettingsLayoutItem.Content>
                        </suki:SettingsLayoutItem>
                    </objectModel:ObservableCollection>
                </suki:SettingsLayout.Items>
            </suki:SettingsLayout>
        </suki:SukiStackPage.Content>
    </suki:SukiStackPage>
</UserControl>